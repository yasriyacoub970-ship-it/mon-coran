<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Saint Coran & Tasbih</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #27ae60;
            --bg-dark: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-color: #e0e0e0;
        }

        body { 
            font-family: 'Segoe UI', sans-serif; 
            background-color: var(--bg-dark); 
            color: var(--text-color); 
            line-height: 1.6;
            margin: 0;
            overflow-x: hidden;
        }

        /* --- MENU LATÃ‰RAL --- */
        .sidebar {
            height: 100%; width: 0; position: fixed; z-index: 1000;
            top: 0; left: 0; background-color: #111;
            overflow-x: hidden; transition: 0.4s; padding-top: 60px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.5);
        }
        .sidebar a {
            padding: 15px 25px; text-decoration: none; font-size: 20px;
            color: #818181; display: block; transition: 0.3s; cursor: pointer;
        }
        .sidebar a:hover { color: var(--primary-color); background: #1a1a1a; }
        .sidebar .closebtn { position: absolute; top: 10px; right: 25px; font-size: 36px; }

        /* --- HEADER --- */
        header {
            background: #111; padding: 15px 20px; display: flex;
            align-items: center; border-bottom: 2px solid var(--primary-color);
            position: sticky; top: 0; z-index: 900;
        }
        .menu-icon { font-size: 30px; cursor: pointer; color: var(--primary-color); margin-right: 20px; }

        /* --- CONTENU --- */
        .container { max-width: 900px; margin: 20px auto; padding: 0 20px; }
        .page-section { display: none; }
        .active-section { display: block; }

        /* --- STYLE CORAN --- */
        .controls { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        select {
            padding: 12px; border-radius: 8px; border: none;
            background: var(--card-bg); color: white; font-size: 16px; flex: 1;
        }
        button {
            padding: 12px 25px; background: var(--primary-color);
            border: none; border-radius: 8px; color: white;
            font-weight: bold; cursor: pointer;
        }
        .verset { 
            background: var(--card-bg); padding: 25px; margin: 20px 0; 
            border-radius: 12px; border-right: 5px solid var(--primary-color); 
            transition: background 0.5s;
        }
        .arabe { 
            font-family: 'Amiri', serif; font-size: 38px; text-align: right; 
            direction: rtl; margin-bottom: 15px; line-height: 1.8;
        }
        .francais { color: #bdc3c7; display: none; border-top: 1px dashed #444; padding-top: 15px; }
        .btn-traduction { background: #34495e; font-size: 12px; margin-top: 10px; }
        
        .merit-box {
            margin: 15px auto; padding: 15px; background: rgba(39, 174, 96, 0.15); 
            border-left: 5px solid #27ae60; font-style: italic; font-size: 15px; 
            max-width: 85%; border-radius: 8px; color: #fff; text-align: left;
        }

        /* --- STYLE TASBIH --- */
        .tasbih-container {
            text-align: center; margin-top: 50px; background: var(--card-bg);
            padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        #counter { font-size: 80px; font-weight: bold; color: var(--primary-color); margin: 20px 0; }
        .btn-tasbih { width: 150px; height: 150px; border-radius: 50%; font-size: 24px; border: 5px solid #1a1a1a; }
        .btn-reset { background: #e74c3c; margin-top: 10px; }
    </style>
</head>
<body>

<div id="mySidebar" class="sidebar">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <a onclick="showSection('coran')">ðŸ“– Le Coran</a>
    <a onclick="showSection('tasbih')">ðŸ“¿ Tasbih</a>
</div>

<header>
    <span class="menu-icon" onclick="openNav()">&#9776;</span>
    <h2 style="margin:0; color:var(--primary-color)">IslamApp</h2>
</header>

<div class="container">
    <section id="section-coran" class="page-section active-section">
        <h1 style="text-align:center">Le Saint Coran</h1>
        <div class="controls">
            <select id="surahSelect"><option value="">Chargement...</option></select>
            <button onclick="loadSurah()">Afficher</button>
        </div>
        
        <div id="surah-dashboard"></div>
        
        <div id="status"></div>
        <div id="quran-display"></div>
    </section>

    <section id="section-tasbih" class="page-section">
        <h1 style="text-align:center">Tasbih NumÃ©rique</h1>
        <div class="tasbih-container">
            <div id="counter">0</div>
            <button class="btn-tasbih" onclick="increment()">+1</button><br>
            <button class="btn-reset" onclick="resetCounter()">RÃ©initialiser</button>
        </div>
    </section>
</div>

<script>
function openNav() { document.getElementById("mySidebar").style.width = "250px"; }
function closeNav() { document.getElementById("mySidebar").style.width = "0"; }

function showSection(sectionId) {
    document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active-section'));
    document.getElementById('section-' + sectionId).classList.add('active-section');
    closeNav();
}

let count = localStorage.getItem('tasbihCount') ? parseInt(localStorage.getItem('tasbihCount')) : 0;
function updateDisplay() {
    document.getElementById('counter').innerText = count;
    localStorage.setItem('tasbihCount', count);
    if(window.navigator.vibrate) window.navigator.vibrate(50);
}
function increment() { count++; updateDisplay(); }
function resetCounter() { if(confirm("RÃ©initialiser ?")) { count = 0; updateDisplay(); } }

const surahNamesFr = ["L'Ouverture", "La Vache", "La Famille d'Imran", "Les Femmes", "La Table Servie", "Les Bestiaux", "Les Murailles", "Le Butin", "Le Repentir", "Jonas", "Hud", "Joseph", "Le Tonnerre", "Abraham", "Al-Hijr", "Les Abeilles", "Le Voyage Nocturne", "La Caverne", "Marie", "Ta-Ha", "Les ProphÃ¨tes", "Le PÃ¨lerinage", "Les Croyants", "La LumiÃ¨re", "Le Discernement", "Les PoÃ¨tes", "Les Fourmis", "Le RÃ©cit", "L'AraignÃ©e", "Les Romains", "Luqman", "La Prosternation", "Les CoalisÃ©s", "Saba", "Le CrÃ©ateur", "Ya-Sin", "Les RangÃ©s", "Sad", "Les Groupes", "Le Pardonneur", "Les Versets DÃ©taillÃ©s", "La Consultation", "L'Ornement", "La FumÃ©e", "L'AgenouillÃ©e", "Al-Ahqaf", "Muhammad", "La Victoire Ã‰clatante", "Les Appartements", "Qaf", "Qui Ã‰parpillent", "At-Tur", "L'Ã‰toile", "La Lune", "Le Tout MisÃ©ricordieux", "L'Ã‰vÃ©nement", "Le Fer", "La Discussion", "L'Exode", "L'Ã‰prouvÃ©e", "Le Rang", "Le Vendredi", "Les Hypocrites", "La Grande Perte", "Le Divorce", "L'Interdiction", "La RoyautÃ©", "La Plume", "Celle qui Montre la VÃ©ritÃ©", "Les Voies d'Ascension", "NoÃ©", "Les Djinns", "L'EnveloppÃ©", "Le RevÃªtu d'un Manteau", "La RÃ©surrection", "L'Homme", "Les EnvoyÃ©s", "La Nouvelle", "Les Anges qui Arrachent les Ã‚mes", "Il s'est RenfrognÃ©", "L'Obscurcissement", "La Rupture", "Les Fraudeurs", "La DÃ©chirure", "Les Constellations", "L'Astre Nocturne", "Le TrÃ¨s-Haut", "L'Enveloppante", "L'Aube", "La CitÃ©", "Le Soleil", "La Nuit", "Le Jour Montant", "L'Ouverture du CÅ“ur", "Le Figuier", "L'AdhÃ©rence", "La DestinÃ©e", "La Preuve Ã‰vidente", "Le Secousse", "Les Coursiers", "Le Fracas", "La Course aux Richesses", "Le Temps", "Les Calomniateurs", "L'Ã‰lÃ©phant", "Les Corayshites", "L'Ustensile", "L'Abondance", "Les InfidÃ¨les", "Le Secours", "Les Fibres", "Le MonothÃ©isme Pure", "L'Aube Naissante", "Les Hommes"];
const surahMerits = { 1: "La plus grande sourate du Coran.", 18: "Une lumiÃ¨re jusqu'au vendredi suivant.", 36: "Le cÅ“ur du Coran.", 67: "IntercÃ¨de jusqu'au pardon.", 112: "Ã‰quivaut Ã  un tiers du Coran.", 113: "Protection contre le mal." };

document.addEventListener("DOMContentLoaded", () => {
    updateDisplay();
    const select = document.getElementById('surahSelect');
    select.innerHTML = '<option value="">-- Choisissez une sourate --</option>';
    surahNamesFr.forEach((name, i) => {
        let opt = document.createElement('option'); opt.value = i + 1;
        opt.innerHTML = `${i + 1}. ${name}`; select.appendChild(opt);
    });
});

async function loadSurah() {
    const num = document.getElementById('surahSelect').value;
    const display = document.getElementById('quran-display');
    const status = document.getElementById('status');
    const dashboard = document.getElementById('surah-dashboard');
    if (!num) return;

    display.innerHTML = ""; dashboard.innerHTML = ""; status.innerText = "Chargement...";

    try {
        const [resAr, resFr] = await Promise.all([
            fetch(`https://api.alquran.cloud/v1/surah/${num}`),
            fetch(`https://api.alquran.cloud/v1/surah/${num}/fr.hamidullah`)
        ]);
        const dataAr = await resAr.json();
        const dataFr = await resFr.json();

        let statusHTML = `Sourate ${num} : <br><span style="font-size:24px">${dataAr.data.name}</span>`;
        if (surahMerits[num]) statusHTML += `<div class="merit-box">ðŸ’¡ ${surahMerits[num]}</div>`;
        status.innerHTML = statusHTML;

        // Dashboard
        const total = dataAr.data.numberOfAyahs;
        dashboard.innerHTML = `
            <div style="background:var(--card-bg); padding:15px; border-radius:8px; display:flex; gap:10px; align-items:center; border:1px solid var(--primary-color); margin-bottom:20px;">
                <span>Verset (1-${total}) :</span>
                <input type="number" id="verseInput" min="1" max="${total}" style="width:60px; padding:5px; background:#111; color:white; border:none;">
                <button onclick="scrollToVerse()" style="padding:5px 15px;">Aller</button>
            </div>`;

        dataAr.data.ayahs.forEach((ayah, i) => {
            const div = document.createElement('div');
            div.className = 'verset';
            div.id = `ayah-${ayah.numberInSurah}`;
            div.innerHTML = `
                <p>Verset ${ayah.numberInSurah}</p>
                <p class="arabe">${ayah.text}</p>
                <p class="francais">${dataFr.data.ayahs[i].text}</p>
                <button class="btn-traduction" onclick="toggleTraduction(this)">Afficher la traduction</button>`;
            display.appendChild(div);
        });
    } catch (e) { status.innerText = "Erreur rÃ©seau."; }
}

function scrollToVerse() {
    const val = document.getElementById('verseInput').value;
    const el = document.getElementById(`ayah-${val}`);
    if (el) { 
        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        el.style.background = "#3e5e4a"; 
        setTimeout(() => el.style.background = "var(--card-bg)", 2000);
    }
}

function toggleTraduction(btn) {
    const trad = btn.parentElement.querySelector('.francais');
    const isHidden = trad.style.display === "none" || trad.style.display === "";
    trad.style.display = isHidden ? "block" : "none";
    btn.innerText = isHidden ? "Masquer la traduction" : "Afficher la traduction";
}
</script>
</body>
</html>
